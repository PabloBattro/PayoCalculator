# Feature Implementation Plan â€” Payo Calculator MVP

**Overall Progress:** `80%`

## TLDR
Build a **public, indicative cross-border transfer cost estimator** for Payoneer.
- High-polish UI (Revolut/Wise quality) with animations
- Server-side pricing engine (no fees in frontend)
- 10 corridors, Payoneerâ†’Bank only for v1
- Indicative positioning with clear disclaimers

## Critical Decisions
- **Separation of concerns**: Frontend presents, backend calculates â€” pricing logic never in client
- **Config-driven pricing**: JSON seed file for MVP, DB-backed later
- **Indicative positioning**: Avoids legal risk; clear disclaimers on every quote
- **FX source**: Static mid-rates for MVP; swap to live feed without UI changes
- **Stack**: Next.js 16 + Tailwind 4 + Framer Motion â€” fast to ship, great DX, Vercel-deployable
- **UI bar**: Revolut/Wise-level polish â€” expandable breakdown, currency search, smooth animations

## Milestone 1 â€” Full E2E Pipeline âœ…

- [x] âœ… **Step 1: Project Setup & Foundation**
  - [x] âœ… Scaffold Next.js 16 app (TypeScript, Tailwind 4, ESLint, App Router)
  - [x] âœ… Configure Tailwind with Payoneer brand tokens (colors in globals.css @theme)
  - [x] âœ… Install Framer Motion
  - [x] âœ… Set up project structure (`components/`, `config/`, `lib/`, `types/`)

- [x] âœ… **Step 2: Pricing Engine & Quote API**
  - [x] âœ… Define TypeScript types (`QuoteRequest`, `QuoteResponse`, `CurrencyConfig`, `PricingRule`)
  - [x] âœ… Create `config/currencies.ts` (10 currencies + metadata + emoji flags)
  - [x] âœ… Create `config/pricing.ts` (fee rules, FX markups, ETAs per corridor with overrides)
  - [x] âœ… Implement `lib/quoteEngine.ts` (calculate fees, apply FX, compute both send/receive)
  - [x] âœ… Implement `POST /api/quote` route with input validation

- [x] âœ… **Step 3: Quote Widget â€” Core UI + Breakdown**
  - [x] âœ… `AmountInput` component (editable amount with currency symbol)
  - [x] âœ… `CurrencyDropdown` component (searchable dropdown with emoji flags)
  - [x] âœ… `QuoteWidget` container (You send / Recipient gets, bidirectional)
  - [x] âœ… Wire inputs to `/api/quote` with 350ms debounce
  - [x] âœ… Fee breakdown (expandable, mathematical notation: âˆ’, =, Ã—)
  - [x] âœ… Exchange rate display with info tooltip (mid-market rate)
  - [x] âœ… ETA display (clock icon + "Should arrive by...")
  - [x] âœ… Disclaimers (indicative, intermediary banks, route-based)
  - [x] âœ… Swap currencies button
  - [x] âœ… Framer Motion: expand/collapse fees, loading bar, section transitions

## Milestone 2 â€” UI Polish, Branding & Deployment âœ…

- [x] âœ… **Step 4: Enhanced UI Components**
  - [x] âœ… Searchable currency dropdown (replace native select)
  - [x] âœ… Copy Payoneer logo SVG to `public/` and use in header
  - [x] âœ… Skeleton loading state during API call
  - [x] âœ… Method selector (Bank transfer selected, future methods greyed out)
  - [x] âœ… Landing page layout (hero text + widget, like Revolut)
  - [x] âœ… Payoneer branding (logo, brand colors)

- [x] âœ… **Step 5: Git, GitHub & Deployment**
  - [x] âœ… Create GitHub repo & push
  - [x] âœ… Deploy to Vercel (live at payocalculator.vercel.app)
  - [x] âœ… `/embed` route for iframe injection into external sites

## Milestone 3 â€” Backend & Pricing Engine âœ…

- [x] âœ… **Step 6: Live FX Rates + Realistic Pricing** (see `plan-pricing-engine-v2.md`)
  - [x] âœ… Integrate Open Exchange Rates (free tier, 1,000 req/month, USD base)
  - [x] âœ… In-memory cache with 10-min TTL, lazy refresh on demand
  - [x] âœ… Triple fallback: live API â†’ cached rates â†’ static seed
  - [x] âœ… Stale rate indicator in UI when serving cached data

- [x] âœ… **Step 7: Realistic Pricing Rules**
  - [x] âœ… Local transfers (same-currency): flat fees ($1.50 major, free exotic)
  - [x] âœ… Non-local corridors: realistic fee % (1â€“4%) and FX markup (0.1â€“0.9%)
  - [x] âœ… Volume discount hint banner (>$10K USD equivalent)
  - [x] âœ… Same-currency UI: FX section hidden, simplified fee display

- [x] âœ… **Step 8: API Hardening** (completed in prior iteration)
  - [x] âœ… Input validation (amount range, valid currency pairs, type checks)
  - [x] âœ… Error responses with clear messages
  - [x] âœ… Same-currency now allowed (was previously blocked)

## Milestone 4 â€” UI Final Polish ðŸŸ¡

- [x] âœ… **Step 9a: Design Polish v1** (see `plan-design-polish-v1.md`)
  - [x] âœ… Format all displayed amounts with thousand separators
  - [x] âœ… Add CTA button below quote ("Get started â€” it's free")
  - [x] âœ… Fix math operator contrast (gray-300 â†’ gray-400, WCAG 3:1)
  - [x] âœ… Grow exchange rate tooltip tap target (14px â†’ 20px + 44px invisible area)
  - [x] âœ… Remove pulse from "Indicative estimates" badge
  - [x] âœ… Append date to ETA label (e.g. "Tuesday, Feb 18")

- [x] âœ… **Step 9b: Design Alignment v1** (see `plan-design-alignment-v1.md`)
  - [x] âœ… Card radius â†’ 20px (match internal FX widget)
  - [x] âœ… Currency selector â†’ pill shape with circular flag
  - [x] âœ… CTA button proportions (rounded-2xl, py-3.5, text-[15px])
  - [x] âœ… Loading state: "Calculating your quoteâ€¦" message
  - [x] âœ… "Rate updated X min ago" timestamp near exchange rate
  - [x] âœ… Method selector tab radius â†’ rounded-xl

- [x] âœ… **Step 9c: Violet CTA + Real Flags** (see `plan-violet-cta-and-flags.md`)
  - [x] âœ… Violet gradient tokens in globals.css
  - [x] âœ… CTA buttons switched from coral to violet gradient
  - [x] âœ… Emoji flags replaced with flagcdn.com images (cross-platform)
  - [x] âœ… `countryCode` field added to CurrencyConfig

- [ ] ðŸŸ¥ **Step 9d: Remaining Visual Refinements**
  - [ ] ðŸŸ¥ Number counting animation on amount change
  - [ ] ðŸŸ¥ Responsive design (mobile-first)
  - [ ] ðŸŸ¥ Meta tags + SEO basics

- [ ] ðŸŸ¥ **Step 10: Quality & Accessibility**
  - [ ] ðŸŸ¥ Accessibility pass (keyboard nav, ARIA labels, focus states)
  - [ ] ðŸŸ¥ Error handling in UI (API failure, timeout, edge cases)
  - [ ] ðŸŸ¥ Code review pass
  - [ ] ðŸŸ¥ Update `docs/architecture.md` with any changes
  - [ ] ðŸŸ¥ Verify disclaimers with legal (placeholder for now)
